{"version":3,"sources":["LongPulling.jsx","App.js","index.js"],"names":["LongPulling","useState","messages","setMessages","value","setValue","subscribe","a","axios","get","data","prev","setTimeout","useEffect","sendMessage","post","message","id","Date","now","className","onChange","e","target","type","onClick","map","mess","App","ReactDOM","render","document","getElementById"],"mappings":"8NAmDeA,EAhDK,WAAO,IAAD,EACUC,mBAAS,IADnB,mBACfC,EADe,KACLC,EADK,OAEIF,mBAAS,IAFb,mBAEfG,EAFe,KAERC,EAFQ,KAKhBC,EAAS,uCAAG,8BAAAC,EAAA,+EAEaC,IAAMC,IAAI,sCAFvB,uBAEFC,EAFE,EAEFA,KACRP,GAAY,SAAAQ,GAAI,OAAKD,GAAL,mBAAcC,OAHpB,SAKJL,IALI,yDAOVM,YAAW,WACPN,MACD,KATO,0DAAH,qDAafO,qBAAU,WACNP,MACD,IAEH,IAAMQ,EAAW,uCAAG,sBAAAP,EAAA,sEACVC,IAAMO,KAAK,qCAAsC,CACnDC,QAASZ,EACTa,GAAIC,KAAKC,QAHG,2CAAH,qDAOjB,OACI,qBAAKC,UAAU,SAAf,SACI,gCACI,sBAAKA,UAAU,OAAf,UACI,uBAAOhB,MAAOA,EAAOiB,SAAU,SAAAC,GAAC,OAAIjB,EAASiB,EAAEC,OAAOnB,QAAQoB,KAAK,SACnE,wBAAQC,QAASX,EAAjB,uEAEJ,qBAAKM,UAAU,WAAf,SACKlB,EAASwB,KAAI,SAAAC,GAAI,OACd,qBAAKP,UAAU,UAAf,SACKO,EAAKX,SADoBW,EAAKV,eCzB5CW,MAVf,WAEE,OACI,8BACE,cAAC,EAAD,OCNRC,IAASC,OACL,cAAC,EAAD,IACFC,SAASC,eAAe,W","file":"static/js/main.de399870.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from \"axios\";\r\n\r\nconst LongPulling = () => {\r\n    const [messages, setMessages] = useState([]);\r\n    const [value, setValue] = useState('');\r\n\r\n\r\n    const subscribe = async () => {\r\n        try {\r\n            const { data } = await axios.get('http://localhost:5000/get-messages')\r\n            setMessages(prev => [data, ...prev])\r\n            // и снова подписываемя на событие\r\n            await subscribe()\r\n        } catch (e) {\r\n            setTimeout(() => {\r\n                subscribe()\r\n            }, 500)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        subscribe()\r\n    }, [])\r\n\r\n    const sendMessage = async () => {\r\n        await axios.post('http://localhost:5000/new-messages', {\r\n            message: value,\r\n            id: Date.now()\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"center\">\r\n            <div>\r\n                <div className=\"form\">\r\n                    <input value={value} onChange={e => setValue(e.target.value)} type=\"text\" />\r\n                    <button onClick={sendMessage}>Отправить</button>\r\n                </div>\r\n                <div className=\"messages\">\r\n                    {messages.map(mess =>\r\n                        <div className=\"message\" key={mess.id}>\r\n                            {mess.message}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LongPulling;","import React from 'react';\r\nimport './app.css'\r\nimport LongPulling from \"./LongPulling\";\r\n// import EventSourcing from \"./EventSourcing\";\r\n// import WebSock from \"./WebSock\";\r\n\r\nfunction App() {\r\n\r\n  return (\r\n      <div>\r\n        <LongPulling/>\r\n      </div>\r\n  )\r\n}\r\n\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n    <App />,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}